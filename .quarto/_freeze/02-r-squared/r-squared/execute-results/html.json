{
  "hash": "965d6e36aad8ec5f7a2ff1cb28c1f0d3",
  "result": {
    "markdown": "---\ntitle: \"R Cuadrado\"\nformat:\n  html:\n    code-fold: true\n    code-summary: \"Show the code\"\neditor: visual\n---\n\n\n## Librerías\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"show\"}\nlibrary(ggplot2)\nlibrary(dplyr)\noptions(scipen = 999)\n```\n:::\n\n\n## Ejemplo 1\n\nSe trata de explicar el precio de una casa (en miles de dólares) usando su tamaño (m2).\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncasas <- data.frame(price = c(120, 85, 67, 200, 110, 154), \n                    size = c(140, 92, 70, 150, 100, 120))\n\nmean_price <- mean(casas$price)\n```\n:::\n\n\n### Total Sum of Squares\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Dataframe for the segments of error\ncasas_segments_mean <- casas %>% mutate(x = size,\n                                        xend = size,\n                                        y = price,\n                                        yend = mean_price)\n\nggplot(casas) +\n  geom_point(aes(x = size, y = price), size = 3) +\n  geom_hline(yintercept = mean_price, color = \"red\", size = 1) +\n  geom_segment(data = casas_segments_mean, aes(x = x, y = y, xend = xend, yend = yend), \n               colour = \"blue\",\n               size = 1) \n```\n\n::: {.cell-output-display}\n![](r-squared_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n### Sum of Squares of Residuals.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#|message: false\n#|warning: false\nlin_mod <- lm(price ~ size, data = casas)\ncasas$predicted_price <- lin_mod$fitted.values\n\n\nggplot(casas, aes(x = size, y = price)) +\n  geom_point(size = 3) +\n  geom_smooth(method = \"lm\", se = FALSE, color = \"red\", size = 1) +  \n  geom_segment(aes(xend = size, yend = predicted_price), color = \"darkgreen\", size = 1)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](r-squared_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n## R cuadrado cálculo\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"show\"}\n# Total Sum of Squares. SUM of (y_i - y_mean)^2\nTSS <- sum((casas$price - mean_price)^2)\n\n# Sum of Squares of Residuals. SUM of (y_i - y_hat)^2\nRSS <- sum((casas$price - casas$predicted_price)^2)\n\n# R^2\nR_s <- (TSS - RSS)/(TSS)\n\n# Cálculo obtenido lm\nR_s_lm <- summary(lin_mod)$r.squared\n\nprint(c(R_s, R_s_lm))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.7544956 0.7544956\n```\n:::\n:::\n\n\nNote que $$ R^2 = \\dfrac{TSS-RSS}{TSS} = \\dfrac{TSS}{TSS} - \\dfrac{RSS}{TSS} $$\n\n$$ R^2 = 1 - \\dfrac{RSS}{TSS}$$\n\nPara nuestro ejemplo:\n\n$$ R^2 = \\dfrac{\n                \\overbrace{11647}^{\\text{VAR a explicar}}     \n                - \n                \\overbrace{2859}^{\\text{VAR NO explicada por modelo}}\n                }\n                {\n                \\underbrace{11647}_{\\text{VAR a explicar}}\n                }\n       = \\dfrac{\n                \\overbrace{11647 - 2859}^{\\text{VAR explicada por el modelo}}  \n                }\n                {\n                \\underbrace{11647}_{\\text{VAR a explicar}}\n                } \n      = 0.7545$$\n\n$R^2$ establece el porcentaje de variación en el **precio (variable respuesta)** que es explicado por el modelo, es decir, por el tamaño **tamaño (variable explicativa)**. En nuestro ejemplo, el 75.45% de variación en el precio es explicado por el tamaño.\n",
    "supporting": [
      "r-squared_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}