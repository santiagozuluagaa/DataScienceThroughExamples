{"title":"R Cuadrado","markdown":{"yaml":{"title":"R Cuadrado","format":{"html":{"code-fold":true,"code-summary":"Show the code"}},"editor":"visual"},"headingText":"Librerías","containsRefs":false,"markdown":"\n\n\n```{r}\n#| code-fold: show\n#| message: false\n#| warning: false\nlibrary(ggplot2)\nlibrary(dplyr)\noptions(scipen = 999)\n```\n\n## Ejemplo 1\n\nSe trata de explicar el precio de una casa (en miles de dólares) usando su tamaño (m2).\n\n```{r}\ncasas <- data.frame(price = c(120, 85, 67, 200, 110, 154), \n                    size = c(140, 92, 70, 150, 100, 120))\n\nmean_price <- mean(casas$price)\n```\n\n### Total Sum of Squares\n\n```{r}\n# Dataframe for the segments of error\ncasas_segments_mean <- casas %>% mutate(x = size,\n                                        xend = size,\n                                        y = price,\n                                        yend = mean_price)\n\nggplot(casas) +\n  geom_point(aes(x = size, y = price), size = 3) +\n  geom_hline(yintercept = mean_price, color = \"red\", size = 1) +\n  geom_segment(data = casas_segments_mean, aes(x = x, y = y, xend = xend, yend = yend), \n               colour = \"blue\",\n               size = 1) \n```\n\n### Sum of Squares of Residuals.\n\n```{r}\n#|message: false\n#|warning: false\nlin_mod <- lm(price ~ size, data = casas)\ncasas$predicted_price <- lin_mod$fitted.values\n\n\nggplot(casas, aes(x = size, y = price)) +\n  geom_point(size = 3) +\n  geom_smooth(method = \"lm\", se = FALSE, color = \"red\", size = 1) +  \n  geom_segment(aes(xend = size, yend = predicted_price), color = \"darkgreen\", size = 1)\n```\n\n## R cuadrado cálculo\n\n```{r}\n#| code-fold: show\n# Total Sum of Squares. SUM of (y_i - y_mean)^2\nTSS <- sum((casas$price - mean_price)^2)\n\n# Sum of Squares of Residuals. SUM of (y_i - y_hat)^2\nRSS <- sum((casas$price - casas$predicted_price)^2)\n\n# R^2\nR_s <- (TSS - RSS)/(TSS)\n\n# Cálculo obtenido lm\nR_s_lm <- summary(lin_mod)$r.squared\n\nprint(c(R_s, R_s_lm))\n```\n\nNote que $$ R^2 = \\dfrac{TSS-RSS}{TSS} = \\dfrac{TSS}{TSS} - \\dfrac{RSS}{TSS} $$\n\n$$ R^2 = 1 - \\dfrac{RSS}{TSS}$$\n\nPara nuestro ejemplo:\n\n$$ R^2 = \\dfrac{\n                \\overbrace{`r round(TSS)`}^{\\text{VAR a explicar}}     \n                - \n                \\overbrace{`r round(RSS)`}^{\\text{VAR NO explicada por modelo}}\n                }\n                {\n                \\underbrace{`r round(TSS)`}_{\\text{VAR a explicar}}\n                }\n       = \\dfrac{\n                \\overbrace{`r round(TSS)` - `r round(RSS)`}^{\\text{VAR explicada por el modelo}}  \n                }\n                {\n                \\underbrace{`r round(TSS)`}_{\\text{VAR a explicar}}\n                } \n      = `r round(R_s, 4)`$$\n\n$R^2$ establece el porcentaje de variación en el **precio (variable respuesta)** que es explicado por el modelo, es decir, por el **tamaño (variable explicativa)**. En nuestro ejemplo, el 75.45% de variación en el precio es explicado por el tamaño.\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","output-file":"r-squared.html"},"language":{"code-summary":"Show the code"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.2.269","editor":"visual","theme":"cosmo","title":"R Cuadrado"},"extensions":{"book":{"multiFile":true}}},"pdf":{"execute":{"fig-width":5.5,"fig-height":3.5,"fig-format":"pdf","fig-dpi":300,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"pdf-engine":"xelatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","output-file":"r-squared.pdf"},"language":{},"metadata":{"block-headings":true,"editor":"visual","documentclass":"scrreprt","title":"R Cuadrado"},"extensions":{"book":{}}}}}