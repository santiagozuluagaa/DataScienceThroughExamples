{"title":"p-values","markdown":{"yaml":{"title":"p-values","format":{"html":{"code-fold":true,"code-summary":"Show the code"}},"editor":"visual"},"headingText":"| code-fold: show","containsRefs":false,"markdown":"\n\n```{r}\nlibrary(ggplot2)\n```\n\n## Ejemplo\n\nUn fabricante de bombillas establece que la duración promedio de sus bombillas es de 10.000 horas. Un auditor externo propone que la duración promedio de las bombillas es en realidad menor de las 10.000 horas.\n\nSe sabe que la duración promedio de una bombilla se distribuye normalmente con $\\sigma^2 = 1000$.\n\nEl auditor consiguió una muestra aleatoria de 28 bombillas y obtuvo una duración promedio de 9500 horas.\n\nRealice una prueba de hipótesis de acuerdo a lo planteado por el auditor externo.\n\n## Definición\n\nSea:\n\n-   X = Duración de una bombilla de la población de interés\n\n## Hipótesis\n\n$$ H_0: \\mu = 10.000 \\ \\text{horas}  \n    \\ \\ \\ \\ \\ \n   H_A: \\mu < 10.000 \\ \\text{horas}$$\n\n## Estadístico de Prueba\n\nPara este caso, se tiene que:\n\n-   $X$ se distribuye normalmente.\n-   $\\sigma^2 = 1000$\n-   $n = 28$\n\nEl estadístico de prueba es:\n\n$$ Z_c =  \\dfrac{\\overline{X}-\\mu_0}{\\dfrac{\\sigma}{\\sqrt{n}}}$$\n\n```{r}\nZ_c <- (9500 - 10000) / (1500 / sqrt(28))\n```\n\n$$ Z_c = \\dfrac{9500-10000}{\\dfrac{1500}{\\sqrt{28}}} = `r round(Z_c,4)`$$\n\n## Valor p\n\nEs la probabilidad de obtener un valor para el estadístico de prueba que sea igual o más extremo de contradictorio a $H_0$ que el valor obtenido, suponiendo que $H_0$ es verdadera.\n\n$$ \\text{valor p} =  P(Z \\leq Z_c) =P(Z < Z_c)  $$\n\nPara este caso:\n\n```{r}\np <- pnorm(Z_c)\n```\n\n$$ \\text{valor p} = P(Z < Z_c) = `r round(p, 4)`$$\n\n```{r}\nggplot(data.frame(x = c(-3, 3)), aes(x)) +\n   stat_function(fun = dnorm,\n                 geom = \"line\",\n                 xlim = c(-3, 3)) +\n   stat_function(fun = dnorm,\n                 geom = \"area\",\n                 fill = \"blue\",\n                 xlim = c(-3, Z_c)) +\n   geom_vline(xintercept = Z_c, colour=\"red\", linetype = \"longdash\") +\n   annotate(\"text\", label = \"Z_c\", x = -2, y = 0.3) +\n   annotate(\"text\", label = \"Valores igual o \\n más extremos de \\n contradictorio \\n que Z_c a la \\n hipótesis nula\", x = -2.5, y = 0.2) +\n    annotate(\"text\", label = \"El área en azul \\n representa tal \\n probabilidad\", x = -2.5, y = 0.1, color = \"blue\") +\n   geom_segment(\n       aes(x = Z_c, y = 0, xend = -3, yend = 0), \n       color = \"red\",\n       size = 1.2,\n       arrow = arrow(length = unit(4, \"mm\"))\n       ) +\n   xlim(-3, 3) +\n   labs(x = \"Z\", y = \"density\")\n```\n\n**¿Por qué se rechaza la hipótesis nula para valores bajos de** $H_0$?\n\nEl valor se calcula suponiendo que la hipótesis nula es verdadera.\n\nPor ejemplo, para este caso, suponiendo que $\\mu = 10000 \\ \\text{horas}$, la probabilidad de que $Z_c < `r round(Z_c, 4)`$ es de $`r round(p, 4)`$ (valor p).\n\nEntre más pequeño es valor p, más contradictorios son los datos a $H_0$.\n\nEn este caso, con cualquier nivel de significancia ($\\alpha$) mayor a $`r round(p, 4)`$, se rechaza la hipótesis nula.\n\nDe aquí se deriva una definición alternativa para el valor p (o nivel de significación observado): \"es el nivel de significancia más pequeño al cual $H_0$ sería rechazada\".\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","output-file":"p-values.html"},"language":{"code-summary":"Show the code"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.2.269","editor":"visual","theme":"cosmo","title":"p-values"},"extensions":{"book":{"multiFile":true}}},"pdf":{"execute":{"fig-width":5.5,"fig-height":3.5,"fig-format":"pdf","fig-dpi":300,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"pdf-engine":"xelatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","output-file":"p-values.pdf"},"language":{},"metadata":{"block-headings":true,"editor":"visual","documentclass":"scrreprt","title":"p-values"},"extensions":{"book":{}}}}}